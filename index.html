<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Palliative Care Monitor โข KPI2</title>
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css" />
</head>

<!--
  ููุงุญุธุงุช ูููุฉ:
  - ุงูุชููุงุช ุชูุถุจุท ุนุจุฑ data-theme ุนูู <body>.
  - ุณุฑุนุฉ/ููุน ุงูุชุฑุงูุฒุดู ุฑุญ ุชุชุนุฏู ูู preferences (ุชูุฎุฒููู ูุญููุงู)ุ ููุทุจูููุง app.js ุจุชุญุฏูุซ CSS variables.
  - ุงูุงุชุตุงู ุจู GAS ุนุจุฑ JSONP ุฑุญ ูููู ูู app.js (ููู ูุงุญู)ุ ูGAS_URL ุงูุงูุชุฑุงุถู ููุญุฏูุฏ ูู schema.js.
-->

<body data-theme="ocean">
  <div id="app" class="app">
    <!-- ุดุฑูุท ุงูุฅุดุนุงุฑ ุงูุนุงู (ุจุฏุก ููู ุฌุฏูุฏ/ุฃุฎุทุงุก/ูุฌุงุญ) -->
    <div id="toast" class="toast toast-hidden" role="status" aria-live="polite">
      <span id="toast-text">โ</span>
      <button id="toast-close" class="btn btn-ghost" aria-label="ุฅุบูุงู">ร</button>
    </div>

    <!-- ุชุฑููุณุฉ -->
    <header class="app-header">
      <div class="brand">
        <div class="brand-icon glow-pulse" aria-hidden="true">โฆ</div>
        <div>
          <h1 class="brand-title">Palliative Care Monitor</h1>
          <div class="brand-sub">Team: ุฌูุงุฏ ุฃุจู ุตุจุญุฉ โข ุฃุตุงูุฉ ููุจุงูู โข ุฃููู ุฏุญุฏููุงู</div>
        </div>
      </div>

      <div class="header-actions">
        <div class="theme-switcher">
          <label for="theme-select" class="label">ุงูุซูู</label>
          <select id="theme-select" class="select">
            <option value="ocean">ocean</option>
            <option value="glow">glow</option>
            <option value="mint">mint</option>
            <option value="rose">rose</option>
            <option value="down">down</option>
            <option value="upper">upper</option>
            <option value="dark">dark</option>
            <option value="light-blue">light blue</option>
            <option value="dark-blue">dark blue</option>
            <option value="tirkwaz">tirkwaz</option>
            <option value="gradient">gradient</option>
          </select>
        </div>

        <button id="btn-preferences" class="btn btn-primary" aria-haspopup="dialog">
          โ๏ธ ุงูุชูุถููุงุช
        </button>
      </div>
    </header>

    <!-- ุดุฑูุท ุงูุฃุฏูุงุช ุงูุนููู -->
    <section class="toolbar">
      <div class="date-wrap">
        <div class="date-today">
          <span class="muted">ุงูููู:</span>
          <strong id="today-label">โ</strong>
        </div>
        <button id="btn-new-day" class="btn btn-success">
          โณ ุจุฏุก ููู ุฌุฏูุฏ
        </button>
      </div>

      <div class="import-actions">
        <div class="import-group">
          <button id="btn-add-manual" class="btn btn-accent">โ ุฅุถุงูุฉ ูุฑูุถ</button>
          <button id="btn-import-out" class="btn">โฌ๏ธ ุงุณุชูุฑุงุฏ Outpatient CSV</button>
          <button id="btn-import-in" class="btn">โฌ๏ธ ุงุณุชูุฑุงุฏ Inpatient CSV</button>
          <a id="btn-download-template" class="btn btn-ghost" download href="#">
            โค ุชูุฒูู ุงููุงูุจ
          </a>
        </div>

        <div class="out-type">
          <label class="label">ููุน Outpatient</label>
          <select id="out-type-select" class="select">
            <option value="">โ</option>
            <option value="OPC">OPC</option>
            <option value="Clinic consult">Clinic consult</option>
            <option value="TR">TR</option>
            <option value="P.Office">P.Office</option>
            <option value="other">other</option>
          </select>
          <input id="out-type-other" class="input" type="text" placeholder="ุงูุชุจ ุงููุณู ุนูุฏ ุงุฎุชูุงุฑ other" />
        </div>
      </div>
    </section>

    <!-- ุนุฏูุงุฏุงุช ุงููุฑูู -->
    <section class="counters">
      <div class="counter-card">
        <div class="counter-title">ุฌูุงุฏ ุฃุจู ุตุจุญุฉ</div>
        <div id="count-jawad" class="counter-num">0</div>
      </div>
      <div class="counter-card">
        <div class="counter-title">ุฃุตุงูุฉ ููุจุงูู</div>
        <div id="count-asala" class="counter-num">0</div>
      </div>
      <div class="counter-card">
        <div class="counter-title">ุฃููู ุฏุญุฏููุงู</div>
        <div id="count-amin" class="counter-num">0</div>
      </div>
      <div class="counter-card alt">
        <div class="counter-title">ุฅุฌูุงูู ุงูููู</div>
        <div id="count-total" class="counter-num">0</div>
      </div>
    </section>

    <!-- ููุงุชุฑ -->
    <section class="filters">
      <div class="filter-row">
        <div class="filter-field">
          <label class="label">ุงููุณู</label>
          <input id="filter-dept" class="input" type="text" placeholder="ูุซุงู: ICU / OPC ..." />
        </div>
        <div class="filter-field">
          <label class="label">ููุน ุงูุชุฏุฎู</label>
          <select id="filter-intervention" class="select">
            <option value="">ุงููู</option>
            <option value="refill medication">refill medication</option>
            <option value="reassessment/dose modification">reassessment/dose modification</option>
            <option value="new assessment/new patient">new assessment/new patient</option>
          </select>
        </div>
        <div class="filter-field">
          <label class="label">ุนุถู ุงูุฑุนุงูุฉ ุงูุชูุทูููุฉ</label>
          <select id="filter-member" class="select">
            <option value="">ุงููู</option>
            <option value="ุฌูุงุฏ ุฃุจู ุตุจุญุฉ">ุฌูุงุฏ ุฃุจู ุตุจุญุฉ</option>
            <option value="ุฃุตุงูุฉ ููุจุงูู">ุฃุตุงูุฉ ููุจุงูู</option>
            <option value="ุฃููู ุฏุญุฏููุงู">ุฃููู ุฏุญุฏููุงู</option>
          </select>
        </div>
        <div class="filter-field">
          <label class="label">ุงุณู ุงููุฑูุถ</label>
          <input id="filter-name" class="input" type="text" placeholder="ุจุญุซ ุจุงูุงุณู" />
        </div>
        <div class="filter-field">
          <label class="label">ููุฏ ุงููุฑูุถ</label>
          <input id="filter-code" class="input" type="text" placeholder="ุจุญุซ ุจุงูููุฏ" />
        </div>
        <div class="filter-field">
          <label class="label">ุงูุชุงุฑูุฎ</label>
          <input id="filter-date" class="input" type="date" />
        </div>
        <div class="filter-actions">
          <button id="btn-apply-filters" class="btn btn-primary">ุชุทุจูู</button>
          <button id="btn-clear-filters" class="btn btn-ghost">ูุณุญ</button>
        </div>
      </div>
    </section>

    <!-- ุงูุฌุฏูู ุงูุฏุงุฆู -->
    <section class="table-wrap">
      <div class="table-head">
        <div class="table-title">ุณุฌู ุงููุฑุถู (ูุง ููุญุฐู ุนูุฏ ุจุฏุก ููู ุฌุฏูุฏ)</div>
        <div class="table-actions">
          <button id="btn-export-weekly" class="btn">๐ ุชูุฑูุฑ ุฃุณุจูุนู</button>
          <button id="btn-export-monthly" class="btn">๐๏ธ ุชูุฑูุฑ ุดูุฑู</button>
          <button id="btn-export-yearly" class="btn">๐๏ธ ุชูุฑูุฑ ุณููู</button>
          <button id="btn-sync" class="btn btn-success">โ ูุฒุงููุฉ</button>
        </div>
      </div>

      <div class="table-scroll">
        <table id="patients-table" class="table">
          <thead>
            <tr>
              <th>ุงูุชุงุฑูุฎ</th>
              <th>ุงูุงุณู</th>
              <th>ุงูููุฏ</th>
              <th>In/Out</th>
              <th>Out Type</th>
              <th>ุงููุณู</th>
              <th>ุงูุชุฏุฎู</th>
              <th>ุนุถู ุงูุฑุนุงูุฉ</th>
              <th>ููุงุญุธุงุช</th>
              <th>ุฅุฌุฑุงุกุงุช</th>
            </tr>
          </thead>
          <tbody id="patients-tbody">
            <!-- ูููุฃ ุฏููุงููููุงู -->
          </tbody>
        </table>
      </div>
    </section>

    <!-- ููุงูุฐ ููุจุซูุฉ -->
    <!-- ุฅุถุงูุฉ/ุชุนุฏูู ูุฑูุถ -->
    <dialog id="modal-patient" class="modal">
      <form id="form-patient" class="modal-card" method="dialog">
        <header class="modal-header">
          <h3 id="modal-patient-title">ุฅุถุงูุฉ ูุฑูุถ</h3>
          <button class="btn btn-ghost" type="button" data-close>ร</button>
        </header>

        <div class="modal-body grid-2">
          <div class="field">
            <label class="label">ุงูุชุงุฑูุฎ</label>
            <input id="fld-date" type="date" class="input" required />
          </div>

          <div class="field">
            <label class="label">ุงูุงุณู</label>
            <input id="fld-name" type="text" class="input" required />
          </div>

          <div class="field">
            <label class="label">ุงูููุฏ</label>
            <input id="fld-code" type="text" class="input" />
          </div>

          <div class="field">
            <label class="label">In/Out</label>
            <select id="fld-inout" class="select" required>
              <option value="out">Out patient</option>
              <option value="in">In patient</option>
            </select>
          </div>

          <div class="field">
            <label class="label">Out Type</label>
            <select id="fld-outtype" class="select">
              <option value="">โ</option>
              <option value="OPC">OPC</option>
              <option value="Clinic consult">Clinic consult</option>
              <option value="TR">TR</option>
              <option value="P.Office">P.Office</option>
              <option value="other">other</option>
            </select>
            <input id="fld-outtype-other" class="input mt-2" type="text" placeholder="ูุณู ุขุฎุฑ..." />
          </div>

          <div class="field">
            <label class="label">ุงููุณู</label>
            <input id="fld-dept" type="text" class="input" placeholder="ICU / OPD / Ward ..." />
          </div>

          <div class="field">
            <label class="label">ุงูุชุฏุฎู</label>
            <select id="fld-intervention" class="select" required>
              <option value="refill medication">refill medication</option>
              <option value="reassessment/dose modification">reassessment/dose modification</option>
              <option value="new assessment/new patient">new assessment/new patient</option>
            </select>
          </div>

          <div class="field">
            <label class="label">ุนุถู ุงูุฑุนุงูุฉ</label>
            <select id="fld-member" class="select" required>
              <option value="ุฌูุงุฏ ุฃุจู ุตุจุญุฉ">ุฌูุงุฏ ุฃุจู ุตุจุญุฉ</option>
              <option value="ุฃุตุงูุฉ ููุจุงูู">ุฃุตุงูุฉ ููุจุงูู</option>
              <option value="ุฃููู ุฏุญุฏููุงู">ุฃููู ุฏุญุฏููุงู</option>
            </select>
          </div>

          <div class="field field-col">
            <label class="label">ููุงุญุธุงุช</label>
            <textarea id="fld-notes" class="textarea" rows="3" placeholder="..."></textarea>
          </div>
        </div>

        <footer class="modal-footer">
          <button class="btn btn-primary" id="btn-save-patient" type="submit">ุญูุธ</button>
          <button class="btn btn-ghost" type="button" data-close>ุฅูุบุงุก</button>
        </footer>
      </form>
    </dialog>

    <!-- ุงุณุชูุฑุงุฏ CSV -->
    <dialog id="modal-import" class="modal">
      <form id="form-import" class="modal-card" method="dialog" enctype="multipart/form-data">
        <header class="modal-header">
          <h3 id="modal-import-title">ุงุณุชูุฑุงุฏ CSV</h3>
          <button class="btn btn-ghost" type="button" data-close>ร</button>
        </header>
        <div class="modal-body">
          <div class="field">
            <label class="label">ุงุฎุชุฑ ููู CSV</label>
            <input id="fld-file" class="input" type="file" accept=".csv,text/csv" required />
          </div>
          <p class="muted">ุณูุชู ุชุฌุงูู ุงูุฃุนูุฏุฉ ุงููุงุฑุบุฉ ุชููุงุฆูุงู ุนูุฏ ุงูุชุนุจุฆุฉ.</p>
          <div class="field">
            <label class="label">ุชุทุจูู ุนุถู ุงูุฑุนุงูุฉ ุนูู ูู ุงููุฑุถู (ุงุฎุชูุงุฑู)</label>
            <select id="fld-bulk-member" class="select">
              <option value="">โ ูุง ุดูุก โ</option>
              <option value="ุฌูุงุฏ ุฃุจู ุตุจุญุฉ">ุฌูุงุฏ ุฃุจู ุตุจุญุฉ</option>
              <option value="ุฃุตุงูุฉ ููุจุงูู">ุฃุตุงูุฉ ููุจุงูู</option>
              <option value="ุฃููู ุฏุญุฏููุงู">ุฃููู ุฏุญุฏููุงู</option>
            </select>
          </div>
          <div class="field">
            <label class="label">ุชุทุจูู ุงููุณู ุนูู ูู ุงููุฑุถู (ุงุฎุชูุงุฑู)</label>
            <input id="fld-bulk-dept" class="input" type="text" placeholder="ICU / Ward / OPC ..." />
          </div>
        </div>
        <footer class="modal-footer">
          <button id="btn-import-submit" class="btn btn-primary" type="submit">ุงุณุชูุฑุงุฏ</button>
          <button class="btn btn-ghost" type="button" data-close>ุฅูุบุงุก</button>
        </footer>
      </form>
    </dialog>

    <!-- ุงูุชูุถููุงุช -->
    <dialog id="modal-preferences" class="modal">
      <form id="form-preferences" class="modal-card" method="dialog">
        <header class="modal-header">
          <h3>ุงูุชูุถููุงุช</h3>
          <button class="btn btn-ghost" type="button" data-close>ร</button>
        </header>

        <div class="modal-body grid-2">
          <div class="field">
            <label class="label">ุณุฑุนุฉ ุงูุญุฑูุงุช (ms)</label>
            <input id="pref-speed" class="input" type="number" min="80" max="2000" step="20" value="240" />
          </div>

          <div class="field">
            <label class="label">ููุน ุงูุญุฑูุฉ ุงูุงูุชุฑุงุถู</label>
            <select id="pref-motion" class="select">
              <option value="slide">slide</option>
              <option value="fade">fade</option>
              <option value="glow">glow</option>
            </select>
          </div>

          <div class="field field-col">
            <label class="label">Google Apps Script URL (ุงุฎุชูุงุฑู ุงูุขู)</label>
            <input id="pref-gas-url" class="input" type="url" placeholder="https://script.google.com/macros/s/XXXXX/exec" />
            <p class="muted">ูุชู ูุถุน Default ูู schema.js โ ููููู ุชุฌุงูุฒู ููุง.</p>
          </div>

          <div class="field">
            <label class="label">ุญูุธ ุชููุงุฆู ุฅูู Google Sheets</label>
            <select id="pref-auto-sync" class="select">
              <option value="on">ุชุดุบูู</option>
              <option value="off">ุฅููุงู</option>
            </select>
          </div>

          <div class="field">
            <label class="label">ูุถุน ุงููุงุฌูุฉ</label>
            <select id="pref-ui-density" class="select">
              <option value="cozy">ูุฑูุญ</option>
              <option value="compact">ูุถุบูุท</option>
            </select>
          </div>
        </div>

        <footer class="modal-footer">
          <button class="btn btn-primary" id="btn-save-preferences" type="submit">ุญูุธ</button>
          <button class="btn btn-ghost" type="button" data-close>ุฅูุบุงุก</button>
        </footer>
      </form>
    </dialog>

    <!-- ููุงูุจ ูุฎููุฉ (ููุงุณุชุนูุงู ุนุจุฑ JS) -->
    <template id="row-template">
      <tr class="row-enter">
        <td data-col="date"></td>
        <td data-col="name"></td>
        <td data-col="code"></td>
        <td data-col="inout"></td>
        <td data-col="outtype"></td>
        <td data-col="dept"></td>
        <td data-col="intervention"></td>
        <td data-col="member"></td>
        <td data-col="notes"></td>
        <td class="row-actions">
          <button class="btn btn-xs btn-ghost" data-action="edit">ุชุนุฏูู</button>
          <button class="btn btn-xs btn-danger" data-action="delete">ุญุฐู</button>
        </td>
      </tr>
    </template>

    <footer class="app-footer">
      <small>ยฉ KPI2 โข Web App runs static (GitHub Pages) โข JSONP ูุน GAS ูุชูุงุฏู CORS</small>
    </footer>
  </div>

  <!-- ุชุญููู ุงูุณูุฑุจุชุงุช -->

  <script type="module" src="./app.js"></script>
<script type="module" src="./schema.js"></script>
<script type="module" src="./analytics.js"></script>

</body>
</html>
